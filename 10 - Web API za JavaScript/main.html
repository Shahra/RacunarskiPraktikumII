<!DOCTYPE html>
<html>
<head>
    <meta charset="utf8" />
    <title>Zadatak 4 - Crtanje po canvasu sa workerima</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
</head>
<body>
<canvas height="600" width="600" id="canvas">
    Ovaj tekst se prikaže ako canvas nije podržan.
</canvas>
<script>
    $( document ).ready( function() {
        var n = 1;
        var cnv = $("#canvas").get(0);
        var ctx = cnv.getContext("2d");
        ctx.font = "14px Arial";
        $("#canvas")
            .on("click", function() {
                var rect = canvas.getBoundingClientRect();
                var x = event.clientX - rect.left,
                    y = event.clientY - rect.top;
                n += 1;
                if( n % 2 === 0) {
                    ctx.fillText("X", x - 5, y + 6);
                    ctx.beginPath();
                    ctx.moveTo(x, y);
                }
                else {
                    ctx.lineTo(x, y);
                    ctx.stroke();
                    ctx.fillText("X", x - 5, y + 6);
                }
            });
        var workers = [];
        for(var i = 0; i < 4; i++) {
            workers[i] = new Worker("CanvasWorker.js");
            workers[i].postMessage("Name " + (i + 1));
            workers[i].onmessage = function(e) {
                ctx.save();
                ctx.translate( e.data.x, e.data.y );
                ctx.rotate(e.data.alpha);
                ctx.fillText(e.data.ime, 0, 0);
                ctx.restore();
            };
        }
    });
</script>
</body>
</html>